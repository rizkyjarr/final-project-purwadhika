{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0", "generated_at": "2025-02-10T01:41:54.369665Z", "invocation_id": "1b81f9a5-83e7-4c5e-a550-4dd9194ff066", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-10T01:41:44.405516Z", "completed_at": "2025-02-10T01:41:44.428071Z"}, {"name": "execute", "started_at": "2025-02-10T01:41:44.429878Z", "completed_at": "2025-02-10T01:41:46.783558Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.402984619140625, "adapter_response": {"_message": "MERGE (5.0 rows, 14.5 KiB processed)", "code": "MERGE", "rows_affected": 5, "bytes_processed": 14838, "bytes_billed": 20971520, "location": "asia-southeast2", "project_id": "purwadika", "job_id": "6feda772-c21e-4bfb-89a1-d1169b09fcd5", "slot_ms": 4440}, "message": "MERGE (5.0 rows, 14.5 KiB processed)", "failures": null, "unique_id": "model.hailing_project.production_hailing_staging_driver", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT *\n    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_driver`\n),\n\ncleaned AS (\n    SELECT\n        driver_id,\n        name,\n        email,\n        -- Standardizing phone numbers\n        REGEXP_REPLACE(phone_number, r'[\\s\\-\\(\\)]', '') AS phone_number,\n        created_at\n    FROM source\n)\n\nSELECT * FROM cleaned\n\n    WHERE created_at > (\n        SELECT MAX(created_at)\n        FROM `purwadika`.`rizky_dwh_hailing_staging`.`production_hailing_staging_driver`\n    )\n", "relation_name": "`purwadika`.`rizky_dwh_hailing_staging`.`production_hailing_staging_driver`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-10T01:41:44.417852Z", "completed_at": "2025-02-10T01:41:44.435038Z"}, {"name": "execute", "started_at": "2025-02-10T01:41:44.481263Z", "completed_at": "2025-02-10T01:41:46.860014Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.4771368503570557, "adapter_response": {"_message": "MERGE (5.0 rows, 11.8 KiB processed)", "code": "MERGE", "rows_affected": 5, "bytes_processed": 12123, "bytes_billed": 20971520, "location": "asia-southeast2", "project_id": "purwadika", "job_id": "78877f7a-8868-43da-934f-d3c0676a6410", "slot_ms": 3817}, "message": "MERGE (5.0 rows, 11.8 KiB processed)", "failures": null, "unique_id": "model.hailing_project.production_hailing_staging_vehicle", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT *\n    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_vehicle`\n)\n\nSELECT *\nFROM source\n\n    WHERE created_at > (\n        SELECT MAX(created_at)\n        FROM `purwadika`.`rizky_dwh_hailing_staging`.`production_hailing_staging_vehicle`\n    )\n", "relation_name": "`purwadika`.`rizky_dwh_hailing_staging`.`production_hailing_staging_vehicle`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-10T01:41:44.388278Z", "completed_at": "2025-02-10T01:41:44.428706Z"}, {"name": "execute", "started_at": "2025-02-10T01:41:44.458133Z", "completed_at": "2025-02-10T01:41:46.878619Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.499598503112793, "adapter_response": {"_message": "MERGE (5.0 rows, 14.6 KiB processed)", "code": "MERGE", "rows_affected": 5, "bytes_processed": 14904, "bytes_billed": 20971520, "location": "asia-southeast2", "project_id": "purwadika", "job_id": "8ae3dc7c-de26-4141-a615-97c7257d77f6", "slot_ms": 3685}, "message": "MERGE (5.0 rows, 14.6 KiB processed)", "failures": null, "unique_id": "model.hailing_project.production_hailing_staging_customer", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT *\n    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_customer`\n),\n\ncleaned AS (\n    SELECT\n        cust_id,\n        name,\n        -- Standardizing phone numbers (removing parentheses, dashes, spaces)\n        REGEXP_REPLACE(phone_number, r'[\\s\\-\\(\\)]', '') AS phone_number,\n        email,\n        created_at\n    FROM source\n)\n\nSELECT * FROM cleaned\n\n    WHERE created_at > (\n        SELECT MAX(created_at)\n        FROM `purwadika`.`rizky_dwh_hailing_staging`.`production_hailing_staging_customer`\n    )\n", "relation_name": "`purwadika`.`rizky_dwh_hailing_staging`.`production_hailing_staging_customer`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-10T01:41:44.411632Z", "completed_at": "2025-02-10T01:41:44.429487Z"}, {"name": "execute", "started_at": "2025-02-10T01:41:44.478127Z", "completed_at": "2025-02-10T01:41:47.730698Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.348799467086792, "adapter_response": {"_message": "MERGE (5.0 rows, 19.1 KiB processed)", "code": "MERGE", "rows_affected": 5, "bytes_processed": 19565, "bytes_billed": 20971520, "location": "asia-southeast2", "project_id": "purwadika", "job_id": "7228b964-a5df-4066-965f-9019c4277d8c", "slot_ms": 3908}, "message": "MERGE (5.0 rows, 19.1 KiB processed)", "failures": null, "unique_id": "model.hailing_project.production_hailing_staging_ride", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT *\n    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_ride`\n)\n\nSELECT *\nFROM source\n\n    WHERE created_at > (\n        SELECT MAX(created_at)\n        FROM `purwadika`.`rizky_dwh_hailing_staging`.`production_hailing_staging_ride`\n    )\n", "relation_name": "`purwadika`.`rizky_dwh_hailing_staging`.`production_hailing_staging_ride`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-10T01:41:46.867906Z", "completed_at": "2025-02-10T01:41:46.882083Z"}, {"name": "execute", "started_at": "2025-02-10T01:41:46.883334Z", "completed_at": "2025-02-10T01:41:49.199163Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.333725690841675, "adapter_response": {"_message": "MERGE (5.0 rows, 23.7 KiB processed)", "code": "MERGE", "rows_affected": 5, "bytes_processed": 24233, "bytes_billed": 31457280, "location": "asia-southeast2", "project_id": "purwadika", "job_id": "39e2ba6a-44c8-4183-8556-62b7de1cb4b4", "slot_ms": 3952}, "message": "MERGE (5.0 rows, 23.7 KiB processed)", "failures": null, "unique_id": "model.hailing_project.dim_driver", "compiled": true, "compiled_code": "\n\n\nWITH driver AS (\n    SELECT *\n    FROM `purwadika`.`rizky_dwh_hailing_staging`.`production_hailing_staging_driver` --pakai ref untuk buat dependency\n\n),\n\nvehicle AS (\n    SELECT *\n    FROM `purwadika`.`rizky_dwh_hailing_staging`.`production_hailing_staging_vehicle`\n)\n\nSELECT\n    driver.driver_id,\n    vehicle.vehicle_id,\n    driver.name AS driver_name,\n    driver.phone_number AS phone_number,\n    driver.email AS email,\n    vehicle.vehicle_type,\n    vehicle.brand AS vehicle_brand,\n    vehicle.year AS vehicle_production_year,\n    vehicle.license_plate,\n    driver.created_at\nFROM driver\nLEFT JOIN vehicle\non driver.driver_id = vehicle.driver_id\n\n\n    WHERE driver.created_at > (\n        SELECT MAX(created_at)\n        FROM `purwadika`.`rizky_dwh_hailing_facts`.`dim_driver`\n    )\n", "relation_name": "`purwadika`.`rizky_dwh_hailing_facts`.`dim_driver`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-10T01:41:46.917857Z", "completed_at": "2025-02-10T01:41:46.927511Z"}, {"name": "execute", "started_at": "2025-02-10T01:41:46.928797Z", "completed_at": "2025-02-10T01:41:49.274862Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.3598756790161133, "adapter_response": {"_message": "MERGE (5.0 rows, 14.4 KiB processed)", "code": "MERGE", "rows_affected": 5, "bytes_processed": 14722, "bytes_billed": 20971520, "location": "asia-southeast2", "project_id": "purwadika", "job_id": "39fc35a1-0e8a-4e83-9865-f53f523a4b58", "slot_ms": 4023}, "message": "MERGE (5.0 rows, 14.4 KiB processed)", "failures": null, "unique_id": "model.hailing_project.dim_customer", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT *\n    FROM `purwadika`.`rizky_dwh_hailing_staging`.`production_hailing_staging_customer`\n)\n\nSELECT * FROM source\n\n    WHERE created_at > (\n        SELECT MAX(created_at)\n        FROM `purwadika`.`rizky_dwh_hailing_facts`.`dim_customer`\n    )\n", "relation_name": "`purwadika`.`rizky_dwh_hailing_facts`.`dim_customer`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-10T01:41:49.283918Z", "completed_at": "2025-02-10T01:41:49.296567Z"}, {"name": "execute", "started_at": "2025-02-10T01:41:49.298186Z", "completed_at": "2025-02-10T01:41:51.739912Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.458584785461426, "adapter_response": {"_message": "MERGE (5.0 rows, 51.2 KiB processed)", "code": "MERGE", "rows_affected": 5, "bytes_processed": 52388, "bytes_billed": 41943040, "location": "asia-southeast2", "project_id": "purwadika", "job_id": "bbb49de0-c323-4487-b912-8c6a81db1732", "slot_ms": 3223}, "message": "MERGE (5.0 rows, 51.2 KiB processed)", "failures": null, "unique_id": "model.hailing_project.fact_hailing_rides", "compiled": true, "compiled_code": "\n\nWITH dim_driver AS (\n\n    SELECT *\n    FROM `purwadika`.`rizky_dwh_hailing_facts`.`dim_driver`\n),\n\ndim_customer AS (\n\n    SELECT * \n    FROM `purwadika`.`rizky_dwh_hailing_facts`.`dim_customer`\n),\n\nride_staging AS (\n\n    SELECT *\n    FROM `purwadika`.`rizky_dwh_hailing_staging`.`production_hailing_staging_ride`\n)\n\nSELECT\nride_staging.ride_id,\nride_staging.start_time AS ride_start_time,\nride_staging.end_time AS ride_end_time,\nride_staging.distance_km,\nride_staging.fare,\nride_staging.ride_status,\ndim_customer.cust_id,\ndim_customer.name AS cust_name,\ndim_customer.phone_number AS cust_phone_number,\ndim_customer.email AS cust_email,\ndim_driver.driver_id,\ndim_driver.driver_name,\ndim_driver.phone_number AS driver_phone_number,\ndim_driver.email AS driver_email,\ndim_driver.vehicle_id,\ndim_driver.vehicle_type,\ndim_driver.vehicle_brand,\ndim_driver.vehicle_production_year,\ndim_driver.license_plate,\nride_staging.created_at\n\nFROM ride_staging\n\nLEFT JOIN dim_customer\non ride_staging.cust_id = dim_customer.cust_id\n\nLEFT JOIN dim_driver\non ride_staging.driver_id = dim_driver.driver_id\n\n\n    WHERE ride_staging.created_at > (\n        SELECT MAX(created_at)\n        FROM `purwadika`.`rizky_dwh_hailing_facts`.`fact_hailing_rides`\n    )\n", "relation_name": "`purwadika`.`rizky_dwh_hailing_facts`.`fact_hailing_rides`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-10T01:41:51.759114Z", "completed_at": "2025-02-10T01:41:51.772792Z"}, {"name": "execute", "started_at": "2025-02-10T01:41:51.774154Z", "completed_at": "2025-02-10T01:41:53.833317Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.0836408138275146, "adapter_response": {"_message": "MERGE (110.0 rows, 25.0 KiB processed)", "code": "MERGE", "rows_affected": 110, "bytes_processed": 25573, "bytes_billed": 31457280, "location": "asia-southeast2", "project_id": "purwadika", "job_id": "85d0380a-24b3-4cb0-b7f6-7e4baa554c4a", "slot_ms": 3994}, "message": "MERGE (110.0 rows, 25.0 KiB processed)", "failures": null, "unique_id": "model.hailing_project.mart_driver_loyalty_mgmt", "compiled": true, "compiled_code": "\n\nWITH dim_driver AS(\n    SELECT *\n    FROM `purwadika`.`rizky_dwh_hailing_facts`.`dim_driver`\n),\n\nfact_rides AS(\n    SELECT *\n    FROM `purwadika`.`rizky_dwh_hailing_facts`.`fact_hailing_rides`\n)\n\nSELECT \ndim_driver.driver_id,\ndim_driver.driver_name,\ndim_driver.phone_number,\ndim_driver.email,\ndim_driver.vehicle_type,\nCOUNT(fact_rides.ride_id) AS no_of_rides,\nSUM(TIMESTAMP_DIFF(fact_rides.ride_end_time, fact_rides.ride_start_time, MINUTE)) AS total_ride_duration_min,\nSUM(fact_rides.fare) AS total_fare,\nSUM(fact_rides.distance_km) as total_distance_km,\nSUM(fact_rides.distance_km)-SUM(fact_rides.fare) AS rev_opportunity_loss,\nFROM dim_driver\nLEFT JOIN fact_rides\nON dim_driver.driver_id = fact_rides.driver_id\n\nGROUP BY driver_id,driver_name,phone_number,email,vehicle_type", "relation_name": "`purwadika`.`rizky_dwh_hailing_marts`.`mart_driver_loyalty_mgmt`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-10T01:41:51.754319Z", "completed_at": "2025-02-10T01:41:51.767111Z"}, {"name": "execute", "started_at": "2025-02-10T01:41:51.768222Z", "completed_at": "2025-02-10T01:41:54.354204Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.605769157409668, "adapter_response": {"_message": "MERGE (91.0 rows, 24.5 KiB processed)", "code": "MERGE", "rows_affected": 91, "bytes_processed": 25068, "bytes_billed": 20971520, "location": "asia-southeast2", "project_id": "purwadika", "job_id": "e426a95e-f7c0-452b-8799-afd3f1b3f163", "slot_ms": 4236}, "message": "MERGE (91.0 rows, 24.5 KiB processed)", "failures": null, "unique_id": "model.hailing_project.mart_cust_rides_daily", "compiled": true, "compiled_code": "\n\n\nWITH fact_rides AS(\n\n    SELECT * \n    FROM `purwadika`.`rizky_dwh_hailing_facts`.`fact_hailing_rides`\n)\n\nSELECT \n\n    fact_rides.cust_id,\n    DATE(fact_rides.created_at) AS ride_date,\n    fact_rides.cust_name,\n    fact_rides.cust_email,\n    fact_rides.cust_phone_number,\n    COUNT(fact_rides.ride_id) AS no_of_rides,\n    SUM(TIMESTAMP_DIFF(fact_rides.ride_end_time, fact_rides.ride_start_time, MINUTE)) AS total_ride_duration_min,\n    SUM(fact_rides.fare) AS total_fare,\n    SUM(fact_rides.distance_km) as total_distance_km,\n    SUM(fact_rides.distance_km)-SUM(fact_rides.fare) AS rev_opportunity_loss,\n\nFROM fact_rides\nGROUP BY cust_name, cust_id, ride_date, cust_email, cust_phone_number", "relation_name": "`purwadika`.`rizky_dwh_hailing_marts`.`mart_cust_rides_daily`", "batch_results": null}], "elapsed_time": 11.179383993148804, "args": {"partial_parse": true, "use_colors_file": true, "send_anonymous_usage_stats": true, "require_explicit_package_overrides_for_builtin_materializations": true, "version_check": true, "defer": false, "warn_error_options": {"include": [], "exclude": []}, "project_dir": "/usr/app/dbt_project", "vars": {}, "log_level_file": "debug", "macro_debugging": false, "which": "run", "exclude": [], "log_format": "default", "require_batched_execution_for_custom_microbatch_strategy": false, "favor_state": false, "state_modified_compare_vars": false, "skip_nodes_if_on_run_start_fails": false, "log_path": "/usr/app/dbt_project/logs", "static_parser": true, "write_json": true, "log_format_file": "debug", "partial_parse_file_diff": true, "empty": false, "printer_width": 80, "indirect_selection": "eager", "profiles_dir": "/usr/app/dbt_project", "introspect": true, "log_level": "info", "invocation_command": "dbt run", "select": [], "show_resource_report": false, "quiet": false, "use_colors": true, "source_freshness_run_project_hooks": false, "state_modified_compare_more_unrendered_values": false, "strict_mode": false, "require_nested_cumulative_type_params": false, "populate_cache": true, "log_file_max_bytes": 10485760, "require_yaml_configuration_for_mf_time_spines": false, "cache_selected_only": false, "require_resource_names_without_spaces": false, "print": true}}